---
# Site-wide playbook - applies common configuration to all infrastructure
# Usage: ansible-playbook playbooks/site.yml

- name: Configure all homelab infrastructure
  hosts: all
  become: true

  pre_tasks:
    - name: Wait for connection
      ansible.builtin.wait_for_connection:
        timeout: 60

    - name: Gather facts
      ansible.builtin.setup:

  roles:
    - role: common
      tags: ['common', 'base']

  post_tasks:
    - name: Display completion message
      ansible.builtin.debug:
        msg:
          - "========================================="
          - "âœ… Configuration complete for {{ inventory_hostname }}"
          - "========================================="
          - "Hostname: {{ ansible_facts['hostname'] }}"
          - "IP Address: {{ ansible_facts['default_ipv4'].address | default('N/A') }}"
          - "OS: {{ ansible_facts['distribution'] }} {{ ansible_facts['distribution_version'] }}"
          - "SSH Keys: Synced from ansible/files/ssh-keys/"
          - "========================================="

# Proxmox host specific configuration
- name: Configure Proxmox host
  hosts: proxmox_host
  become: true

  tasks:
    - name: Proxmox-specific tasks placeholder
      ansible.builtin.debug:
        msg: "Proxmox host configuration (future enhancement)"

# Container-specific configurations
- name: Configure backup containers
  hosts: backup_containers
  become: true

  tasks:
    - name: Backup container placeholder
      ansible.builtin.debug:
        msg: "Backup container-specific configuration goes here"
