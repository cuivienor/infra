---
# Main tasks for common role

- name: Import system configuration tasks
  ansible.builtin.import_tasks: system.yml
  tags: ['system', 'hostname', 'locale', 'timezone']

- name: Import package management tasks
  ansible.builtin.import_tasks: packages.yml
  tags: ['packages']

- name: Import media user tasks
  ansible.builtin.import_tasks: media-user.yml
  tags: ['media-user', 'users']
  when: media_user_enabled | bool

- name: Import admin user tasks
  ansible.builtin.import_tasks: admin-user.yml
  tags: ['admin-user', 'users']
  when: admin_user is defined

- name: Import SSH keys tasks
  ansible.builtin.import_tasks: ssh-keys.yml
  tags: ['ssh-keys', 'ssh']

- name: Import homelab shell tasks
  ansible.builtin.import_tasks: homelab-shell.yml
  tags: ['homelab-shell', 'shell', 'dotfiles']
  when: homelab_shell_enabled | bool

- name: Import needrestart tasks
  ansible.builtin.import_tasks: needrestart.yml
  tags: ['needrestart', 'updates']
  when: needrestart_enabled | bool

# SSH hardening disabled for now - don't want to risk lockout
# TODO: Enable once backup key strategy is in place
# - name: Import SSHD hardening tasks
#   ansible.builtin.import_tasks: sshd.yml
#   tags: ['sshd', 'ssh', 'security']
