# Samba configuration for CT301
# Generated by Ansible - DO NOT EDIT MANUALLY

[global]
   # Server identification
   workgroup = WORKGROUP
   server string = Homelab Storage Server (CT301)
   netbios name = samba

   # Security configuration
   security = user
   passdb backend = tdbsam
   map to guest = never
   guest account = nobody

   # Disable printer sharing
   load printers = no
   printing = bsd
   printcap name = /dev/null
   disable spoolss = yes

   # Logging
   log file = /var/log/samba/%m.log
   max log size = 1000
   log level = 1

   # Performance tuning for large files
   # Optimized for movie file streaming
   socket options = SO_RCVBUF=524288 SO_SNDBUF=524288
   read raw = yes
   write raw = yes
   max xmit = 65536
   aio read size = 16384
   aio write size = 16384
   use sendfile = yes

   # Wide links configuration (required for MergerFS symlinks)
   # MergerFS may use symlinks for file distribution
   unix extensions = no
   allow insecure wide links = yes

   # Disable unnecessary services
   wins support = no
   dns proxy = no

   # Modern SMB protocol versions only
   # Disable SMB1 for security
   server min protocol = SMB2
   client min protocol = SMB2

# Storage share - entire /mnt/storage pool
[storage]
   comment = Homelab Storage Pool (MergerFS)
   path = /mnt/storage
   browseable = yes
   writable = yes

   # Authentication
   valid users = media
   guest ok = no

   # Force ownership to media user
   force user = media
   force group = media

   # Permission masks (match existing storage permissions)
   create mask = 0664
   directory mask = 0775
   force create mode = 0664
   force directory mode = 0775

   # Performance
   wide links = yes
   follow symlinks = yes

   # Disable veto files (allow all file types)
   veto files = /._*/.DS_Store/
   delete veto files = yes
