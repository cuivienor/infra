---
title: "6:24:01 AM - November 9, 2025"
date: 2025-11-09T11:24:01.609Z
timestamp: 1762687441609
---

## Project Notes

## Transcoding Container - Unresolved Permission Issue

After setting up the transcoding container with Intel Arc GPU passthrough, we hit a persistent write permission issue:

### What Works
- GPU passthrough functioning (vainfo works)
- ffmpeg has QSV support
- Container can read from /mnt/media/staging/
- Group memberships are correct (root is in media group 1005)
- Permissions on host are correct (rwxrwxr-x)
- Permissions visible correctly in container

### What Doesn't Work
- Writing to /mnt/media/staging/ fails with "Permission denied"
- Even though root is in group 1005 and directory is group-writable

### Debugging Done
1. Verified chmod g+w actually changed permissions on host
2. Confirmed permissions propagate to container
3. Verified group membership with `id` and `groups`
4. Used fresh login shell (exit/re-enter with `su - root`)
5. Checked mount command for ro flag

### Still Need to Check
1. `mount | grep /mnt/media` output inside container (looking for ro flag)
2. Full mergerfs mount options on host
3. Whether mp0 needs explicit `ro=0` or `shared=1` flag
4. Try running as user 1005 instead of root
5. Check if SELinux/AppArmor is interfering (unlikely)

### Lesson Learned
LXC UID/GID mapping is complex and subtle. Even when everything looks correct (ownership, permissions, group membership), there can be hidden issues with how bind mounts interact with mapped IDs. For mergerfs specifically, the mount options might need special handling.

### Potential Workarounds
1. Run ffmpeg as user 1005 directly (create mediauser with that UID)
2. Output to /tmp in container, then move files (inefficient)
3. Use a different mount method (NFS/SMB instead of bind mount)
4. Make directory 777 (security concern but works for homelab)
